{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container align-items-start\"\n};\nconst _hoisted_2 = {\n  class: \"card\",\n  style: {\n    \"width\": \"40rem\"\n  }\n};\nconst _hoisted_3 = {\n  class: \"card-body\"\n};\nconst _hoisted_4 = {\n  style: {}\n};\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"form-group mb-3\"\n}, [/*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"formTitle\",\n  class: \"form-label\"\n}, \"Titolo\"), /*#__PURE__*/_createElementVNode(\"input\", {\n  class: \"form-control\",\n  type: \"text\",\n  id: \"formTitle\",\n  multiple: \"\"\n})], -1 /* HOISTED */);\nconst _hoisted_6 = {\n  key: 0,\n  id: \"carouselExampleControls\",\n  class: \"carousel slide\",\n  \"data-ride\": \"carousel\"\n};\nconst _hoisted_7 = {\n  class: \"carousel-inner\"\n};\nconst _hoisted_8 = [\"src\"];\nconst _hoisted_9 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"carousel-control-prev-icon\",\n  \"aria-hidden\": \"true\"\n}, null, -1 /* HOISTED */);\nconst _hoisted_10 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"sr-only\"\n}, \"Previous\", -1 /* HOISTED */);\nconst _hoisted_11 = [_hoisted_9, _hoisted_10];\nconst _hoisted_12 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"carousel-control-next-icon\",\n  \"aria-hidden\": \"true\"\n}, null, -1 /* HOISTED */);\nconst _hoisted_13 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"sr-only\"\n}, \"Next\", -1 /* HOISTED */);\nconst _hoisted_14 = [_hoisted_12, _hoisted_13];\nconst _hoisted_15 = {\n  class: \"form-group mb-3\"\n};\nconst _hoisted_16 = /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"formFileMultiple\",\n  class: \"form-label\"\n}, \"Foto\", -1 /* HOISTED */);\nconst _hoisted_17 = {\n  class: \"form-group mb-3 dropdown\"\n};\nconst _hoisted_18 = {\n  class: \"btn btn-secondary dropdown-toggle\",\n  type: \"button\",\n  id: \"catDropdown\",\n  \"data-bs-toggle\": \"dropdown\",\n  \"aria-haspopup\": \"true\",\n  \"aria-expanded\": \"false\"\n};\nconst _hoisted_19 = {\n  class: \"dropdown-menu\",\n  \"aria-labelledby\": \"catDropdown\"\n};\nconst _hoisted_20 = [\"onClick\"];\nconst _hoisted_21 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"form-group\"\n}, [/*#__PURE__*/_createElementVNode(\"label\", {\n  class: \"form-label\",\n  for: \"formDescription\"\n}, \"Descrizione\"), /*#__PURE__*/_createElementVNode(\"textarea\", {\n  class: \"form-control\",\n  type: \"text\",\n  id: \"formDescription\",\n  rows: \"8\",\n  multiple: \"\"\n})], -1 /* HOISTED */);\nconst _hoisted_22 = {\n  class: \"form-group\",\n  style: {\n    \"padding-top\": \"1rem\"\n  }\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"main\", null, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"form\", _hoisted_4, [_hoisted_5, this.images !== undefined && this.images.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(this.imagesUrls, (img, index) => {\n    return _openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createElementVNode(\"div\", {\n      class: _normalizeClass([\"carousel-item\", index === this.imageIndex ? 'active' : ''])\n    }, [_createElementVNode(\"img\", {\n      class: \"d-block card-img-top\",\n      src: img\n    }, null, 8 /* PROPS */, _hoisted_8)], 2 /* CLASS */)]);\n  }), 256 /* UNKEYED_FRAGMENT */)), this.imagesUrls.length > 1 ? (_openBlock(), _createElementBlock(\"a\", {\n    key: 0,\n    class: \"carousel-control-prev\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.prevImage && $options.prevImage(...args)),\n    role: \"button\",\n    \"data-slide\": \"prev\"\n  }, _hoisted_11)) : _createCommentVNode(\"v-if\", true), this.imagesUrls.length > 1 ? (_openBlock(), _createElementBlock(\"a\", {\n    key: 1,\n    class: \"carousel-control-next\",\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.nextImage && $options.nextImage(...args)),\n    role: \"button\",\n    \"data-slide\": \"next\"\n  }, _hoisted_14)) : _createCommentVNode(\"v-if\", true)])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_15, [_hoisted_16, _createElementVNode(\"input\", {\n    class: \"form-control\",\n    type: \"file\",\n    accept: \".jpg, .png, .jpeg, .gif, .bmp, .tif, .tiff|image/*\",\n    id: \"formFileMultiple\",\n    onChange: _cache[2] || (_cache[2] = (...args) => $options.setImages && $options.setImages(...args)),\n    multiple: \"\"\n  }, null, 32 /* HYDRATE_EVENTS */)]), _createElementVNode(\"div\", _hoisted_17, [_createElementVNode(\"button\", _hoisted_18, _toDisplayString(this.listing.category === '' ? 'Seleziona Categoria' : this.listing.category), 1 /* TEXT */), _createElementVNode(\"ul\", _hoisted_19, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(this.categoriesStore.categories, c => {\n    return _openBlock(), _createElementBlock(\"li\", null, [_createElementVNode(\"a\", {\n      class: \"dropdown-item\",\n      onClick: $event => $options.setCat($event, c.attributes.name)\n    }, _toDisplayString(c.attributes.name), 9 /* TEXT, PROPS */, _hoisted_20)]);\n  }), 256 /* UNKEYED_FRAGMENT */))])]), _hoisted_21, _createElementVNode(\"div\", _hoisted_22, [_createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"btn btn-primary\",\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.submit && $options.submit(...args))\n  }, \"Inserisci\")])])])])])]);\n}","map":{"version":3,"names":["class","style","_createElementVNode","for","type","id","multiple","_hoisted_9","_hoisted_10","_hoisted_12","_hoisted_13","rows","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","images","undefined","length","_hoisted_6","_Fragment","_renderList","imagesUrls","img","index","_hoisted_7","_normalizeClass","imageIndex","src","onClick","_cache","args","$options","prevImage","role","nextImage","_hoisted_15","_hoisted_16","accept","onChange","setImages","_hoisted_17","_hoisted_18","_toDisplayString","listing","category","_hoisted_19","categoriesStore","categories","c","$event","setCat","attributes","name","_hoisted_20","_hoisted_21","_hoisted_22","submit"],"sources":["/home/dario/Documenti/GitHub/demo-web-app-frontend/src/views/InsertListing.vue"],"sourcesContent":["<template>\n    <main>\n        <div class=\"container align-items-start\">\n            <div class=\"card\" style=\"width: 40rem;\">\n                <div class=\"card-body\">\n                    <form style=\"\">\n                        <div class=\"form-group mb-3\">\n                            <label for=\"formTitle\" class=\"form-label\">Titolo</label>\n                            <input class=\"form-control\" type=\"text\" id=\"formTitle\" multiple>\n                        </div>\n\n                        <div v-if=\"this.images !== undefined && this.images.length > 0\" \n                        id=\"carouselExampleControls\" class=\"carousel slide\" data-ride=\"carousel\">\n                            <div v-for=\"(img, index) in this.imagesUrls\" class=\"carousel-inner\">\n                                <div class=\"carousel-item\" :class=\" index === this.imageIndex ? 'active' : ''\">\n                                    <img class=\"d-block card-img-top\" :src=\"img\">\n                                </div>\n                            </div>\n                            <a v-if=\"this.imagesUrls.length > 1\" class=\"carousel-control-prev\" @click=\"prevImage\" role=\"button\" data-slide=\"prev\">\n                                <span class=\"carousel-control-prev-icon\" aria-hidden=\"true\"></span>\n                                <span class=\"sr-only\">Previous</span>\n                            </a>\n                            <a v-if=\"this.imagesUrls.length > 1\" class=\"carousel-control-next\" @click=\"nextImage\" role=\"button\" data-slide=\"next\">\n                                <span class=\"carousel-control-next-icon\" aria-hidden=\"true\"></span>\n                                <span class=\"sr-only\">Next</span>\n                            </a>\n                        </div>\n                        <div class=\"form-group mb-3\">\n                            <label for=\"formFileMultiple\" class=\"form-label\">Foto</label>\n                            <input class=\"form-control\" type=\"file\"  accept=\".jpg, .png, .jpeg, .gif, .bmp, .tif, .tiff|image/*\" \n                            id=\"formFileMultiple\" @change=\"setImages\" multiple>\n                        </div>\n\n                        <div class=\"form-group mb-3 dropdown\">\n                            <button class=\"btn btn-secondary dropdown-toggle\" type=\"button\" id=\"catDropdown\" data-bs-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                                {{ this.listing.category === '' ? 'Seleziona Categoria' : this.listing.category }}\n                            </button>\n                            <ul class=\"dropdown-menu\" aria-labelledby=\"catDropdown\">\n                                <li v-for=\"c in this.categoriesStore.categories\"><a class=\"dropdown-item\" @click=\"setCat($event, c.attributes.name)\">{{ c.attributes.name }}</a></li>\n                            </ul>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label class=\"form-label\" for=\"formDescription\">Descrizione</label> \n                            <textarea class=\"form-control\" type=\"text\" id=\"formDescription\" rows=\"8\"  multiple></textarea>\n                        </div>\n                        <div class=\"form-group\" style=\"padding-top: 1rem;\">\n                            <button type=\"submit\" class=\"btn btn-primary\"  @click=\"submit\">Inserisci</button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </main>\n</template>\n\n<script>\n    import axios from 'axios';\n    import { useUserStore } from '@/stores/user';\n    import { useCategoriesStore } from '@/stores/categories';\n\n    export default{\n        name: \"Insert Listing\",\n        data(){\n            return{\n                imageIndex:0,\n            \n                title:'',\n                description:'',\n                price:0,\n                phone:'',\n                email:'',\n                imagesUrl:[],\n                category:'',\n                categoriesStore: Object,\n            \n                images:[],\n                imagesUrls:[],\n            }\n        },\n        created(){\n            this.categoriesStore = useCategoriesStore();\n\n\n        },\n        methods: {\n            nextImage(e){\n                e.preventDefault();\n\n                const carouselItems = document.getElementsByClassName(\"carousel-item\");\n\n                this.imageIndex = (this.imageIndex + 1) % carouselItems.length;\n            },\n            prevImage(e){\n                e.preventDefault();\n\n                const carouselItems = document.getElementsByClassName(\"carousel-item\");\n\n                this.imageIndex = (this.imageIndex - 1) % carouselItems.length;\n                if(this.imageIndex  < 0)\n                    this.imageIndex = carouselItems.length - 1;\n            },\n            setImages(e){\n                e.preventDefault();\n\n                const reader = new FileReader();\n\n                let images = Array.from(e.target.files);\n\n                images = images.filter( f => f['type'] === 'image/jpeg' || f['type'] === 'image/png' )  //filters file that are not images\n\n                this.images = images\n\n                console.log(this.images)\n\n                this.imagesUrls = []\n                \n                if (images) {\n                    Array.prototype.forEach.call(images, this.readAndPreview);\n                }\n                \n            },\n            async submit(e){\n                e.preventDefault();\n\n                const formData = new FormData();\n\n                /*\n                this.images.forEach(img => {\n                    formData.append(`files`, img)\n                })\n\n                const res = await axios.post(\"http://localhost:1337/api/upload\", formData, {\n                headers: { 'Content-Type': 'multipart/form-data' }})\n\n                res.data.forEach( url => this.imagesUrls.push(url) )\n*/\n                const newListing = {\n                    data:{\n                        title: this.title,\n                        description: this.description,\n                        price: this.price,\n                        phone: this.phone,\n                        images: this.images,\n                        email: this.email,\n                        category:-1\n                    }\n                    \n                }\n\n\n                const res = await axios.post(\"http://localhost:1337/api/listings\", newListing, {headers: {\n                Authorization: `Bearer ${useUserStore().jwt}`}\n                })\n\n                console.log(res)\n            },\n            readAndPreview(file) {\n                // Make sure `file.name` matches our extensions criteria\n                const reader = new FileReader();\n\n                reader.addEventListener(\n                    \"load\",\n                    () => {\n                        this.imagesUrls.push(reader.result)\n                    },\n                    false,\n                );\n\n                reader.readAsDataURL(file);\n            },\n            setCat(e, cat){\n                e.preventDefault();\n\n                this.listing.category = cat;\n            }\n        }\n    }\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}