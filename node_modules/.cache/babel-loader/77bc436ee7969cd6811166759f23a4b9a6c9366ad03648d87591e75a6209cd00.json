{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport router from '@/router';\nimport { RouterLink } from 'vue-router';\nimport { useUserStore } from '@/stores/user';\nexport default {\n  name: 'Signup',\n  data() {\n    return {\n      name: '',\n      email: '',\n      password: '',\n      username: '',\n      emailError: false,\n      usernameError: false,\n      passwordError: false,\n      submitted: false\n    };\n  },\n  methods: {\n    async registerUser(e) {\n      e.preventDefault();\n      const user = {\n        name: this.name,\n        email: this.email,\n        password: this.password,\n        username: this.username\n      };\n      console.log(JSON.stringify(user));\n      const requestOptions = {\n        method: 'POST',\n        headers: {\n          'Content-type': 'application/json'\n        },\n        body: JSON.stringify(user)\n      };\n      try {\n        const res = await fetch('http://localhost:1337/api/auth/local/register', requestOptions);\n        const data = res.json();\n        if (res.ok) {\n          const userStore = useUserStore();\n          userStore.$patch({\n            jwt: data.jwt,\n            name: data.user.username\n          });\n          router.push({\n            name: \"home\"\n          });\n        } else {\n          alert(\"Errore nella registrazione\");\n          const errors = data.error.details.errors;\n          this.passwordError = false;\n          this.emailError = false;\n          this.usernameError = false;\n          console.log(errors.length);\n          for (let i = 0; i < errors.length; i++) {\n            this.passwordError = this.passwordError || errors[i].path.length > 0 && errors[i].path.indexOf('password') !== -1; //If the error is not set already and it is found in the path of the received errors\n            this.emailError = this.emailError || errors[i].path.length > 0 && errors[i].path.indexOf('email') !== -1;\n            this.usernameError = this.usernameError || errors[i].path.length > 0 && errors[i].path.indexOf('username') !== -1;\n          }\n          this.submitted = true;\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    goToLogin(e) {\n      e.preventDefault();\n      router.push({\n        name: \"login\"\n      });\n    }\n  }\n};","map":{"version":3,"names":["router","RouterLink","useUserStore","name","data","email","password","username","emailError","usernameError","passwordError","submitted","methods","registerUser","e","preventDefault","user","console","log","JSON","stringify","requestOptions","method","headers","body","res","fetch","json","ok","userStore","$patch","jwt","push","alert","errors","error","details","length","i","path","indexOf","err","goToLogin"],"sources":["/home/dario/Documenti/GitHub/demo-web-app-frontend/src/views/Signup.vue"],"sourcesContent":["<template>\n    <div id=\"background\">\n        <section class=\"vh-100\" id = \"mysection\">\n            <div class=\"container py-5 h-100\">\n            <div class=\"row d-flex justify-content-center align-items-center h-100\">\n            <div class=\"col col-xl-10\">\n                <div class=\"card\" style=\"border-radius: 1rem;\">\n                <div class=\"row g-0\">\n                    <div class=\"col-md-6 col-lg-5 d-none d-md-block\">\n                    <img src=\"https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-login-form/img1.webp\"\n                        alt=\"login form\" class=\"img-fluid\" style=\"border-radius: 1rem 0 0 1rem;\" />\n                    </div>\n                    <div class=\"col-md-6 col-lg-7 d-flex align-items-center\">\n                    <div class=\"card-body p-4 p-lg-5 text-black\">\n\n                        <form :class=\"this.submitted ? 'was-validated':''\">\n\n                        <div class=\"d-flex align-items-center mb-3 pb-1\">\n                            <i class=\"fas fa-cubes fa-2x me-3\" style=\"color: #ff6219;\"></i>\n                            <span class=\"h1 fw-bold mb-0\">Logo</span>\n                        </div>\n\n                        <h5 class=\"fw-normal mb-3 pb-3\" style=\"letter-spacing: 1px;\">Creazione account</h5>\n\n                        <div class=\"form-outline mb-4\">\n                            <label class=\"form-label\" for=\"nameInput\">Nome</label>\n                            <input type=\"text\" id=\"nameInput\" aria-describedby=\"nameFeedback\" class=\"form-control form-control-lg\" \n                            :class=\"this.submitted ? (this.name.length === 0 ? 'is-invalid' : 'is-valid') : ''\" v-model=\"this.name\"/>\n                            <div id=\"nameFeedback\" class=\"invalid-feedback\">\n                                Il campo non può essere vuoto.\n                            </div>\n                        </div>\n\n                        <div class=\"form-outline mb-4\">\n                            <label class=\"form-label\" for=\"usernameInput\">Username</label>\n                            <input type=\"text\" id=\"usernameInput\" aria-describedby=\"usernameFeedback\" class=\"form-control form-control-lg\" \n                            :class=\"this.submitted ? (this.usernameError === true ? 'is-invalid' : 'is-valid') : '' \" v-model=\"this.username\"/>\n                            <div id=\"usernameFeedback\" class=\"invalid-feedback\">\n                                Username già registrato o formato scorretto.\n                            </div>\n                        </div>\n\n                        <div class=\"form-outline mb-4\">\n                            <label class=\"form-label\" for=\"emailInput\">Email</label>\n                            <input type=\"\" id=\"emailInput\" aria-describedby=\"emailFeedback\" class=\"form-control form-control-lg\" \n                            :class=\"this.submitted ? (this.emailError === true ? 'is-invalid' : 'is-valid') : ''\" v-model=\"this.email\"/>\n                            <div id=\"emailFeedback\" class=\"invalid-feedback\">\n                                Email già registrata o formato scorretto.\n                            </div>\n                        </div>\n\n                        <div class=\"form-outline mb-4\">\n                            <label class=\"form-label\" for=\"passwordInput\">Password</label>\n                            <input type=\"password\" id=\"passwordInput\" aria-describedby=\"passwordFeedback\" class=\"form-control form-control-lg\" \n                            :class=\"this.submitted ? (this.passwordError === true ? 'is-invalid' : 'is-valid'):''\" v-model=\"this.password\"/>\n                            <div id=\"passwordFeedback\" class=\"invalid-feedback\">\n                                La password non rispetta i requisiti.\n                            </div>\n                        </div>\n\n                        <div class=\"pt-1 mb-4\">\n                            <button class=\"btn btn-dark btn-lg btn-block\" type=\"button\" @click=\"registerUser\">Registrati</button>\n                        </div>\n\n                        <!--<a class=\"small text-muted\" href=\"#!\">Forgot password?</a>--> \n                        <p class=\"mb-5 pb-lg-2\" style=\"color: #393f81;\">Sei già registrato? <a @click=\"goToLogin\"\n                            style=\"color: #393f81;\">Accedi</a></p>\n                        </form>\n\n                        </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            </div>\n            </div>\n        </section>\n    </div>\n    \n</template>\n\n<script>\n    import router from '@/router';\n    import { RouterLink } from 'vue-router';\n    import { useUserStore } from '@/stores/user'\n\n    export default{\n        name:'Signup',\n        data(){\n            return{\n                name: '',\n                email: '',\n                password: '',\n                username: '',\n                emailError: false,\n                usernameError: false,\n                passwordError: false,\n                submitted: false\n            }\n        },\n        methods:{\n            async registerUser(e){\n                e.preventDefault();\n\n                const user = {\n                    name:this.name,\n                    email:this.email,\n                    password:this.password,\n                    username:this.username\n                }\n\n                console.log(JSON.stringify(user));\n                \n                const requestOptions = {\n                    method: 'POST',\n                    headers: { 'Content-type': 'application/json' },\n                    body: JSON.stringify(user)\n                };\n\n                try{\n                    const res = await fetch('http://localhost:1337/api/auth/local/register', requestOptions);\n                    const data = res.json()\n\n                    if(res.ok){\n                        const userStore = useUserStore();\n\n                        userStore.$patch({ jwt: data.jwt, name: data.user.username })        \n\n\n\n                        router.push({\n                            name:\"home\",\n                        })\n                    }else{\n                        alert(\"Errore nella registrazione\")\n                        const errors = data.error.details.errors;\n\n                        this.passwordError = false;\n                        this.emailError = false;\n                        this.usernameError = false;\n\n                        console.log(errors.length)\n                        for(let i = 0; i < errors.length; i++){\n                            this.passwordError = this.passwordError || (errors[i].path.length > 0 && errors[i].path.indexOf('password') !== -1); //If the error is not set already and it is found in the path of the received errors\n                            this.emailError = this.emailError || (errors[i].path.length > 0 && errors[i].path.indexOf('email') !== -1); \n                            this.usernameError = this.usernameError || (errors[i].path.length > 0 && errors[i].path.indexOf('username') !== -1); \n                        }\n\n                        this.submitted = true;\n                    }\n                }\n                catch(err){\n                    console.log(err)\n                }\n\n            },\n            goToLogin(e){\n                e.preventDefault();\n\n                router.push({ name: \"login\" })\n            }\n        }\n    }\n</script>\n\n<style>\n#background{\n    background-color:cornflowerblue;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    padding-bottom: 10rem;\n}\n\n#mycard{\n    width: 10rem;\n}\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}